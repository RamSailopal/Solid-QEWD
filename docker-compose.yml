#
#       AUTHOR - Raman Sailopal
#
version: "2"
services:
 yottadb:
   hostname: yottadb
   container_name: yottadb
   image: docker.io/ramb0/yottadb-gateway
   networks:
      - yottanet
   ports:
      - 7041:7041
   mem_limit: 1G


 node:
   image: docker.io/ramb0/yottadb-nodejs-client
   hostname: node
   container_name: node
   volumes:
     - yottavol:/home/soliddb
     - "$PWD/QEWDApp:/home/node"
     - "$PWD/sync:/home/sync"
   entrypoint: [ "/bin/bash", "-c", "cd /home/node && yarn add mg-dbx && /home/sync/syncproc.sh" ]
   networks:
      - yottanet


 solid:
   image: docker.io/ramb0/solidserver
   user: root
   volumes:
      - yottavol:/opt/solid/.db
   ports: 
      - 8443:8443
   networks:
      - yottanet
   entrypoint: [ '/bin/sh', '-c', 'export SOLID_REDIRECT_HTTP_FROM=80 && export SOLID_SERVER_URI="$SOLIDURL" && cd /opt/solid && ./entrypoint.sh start']

networks:
    yottanet:
volumes:
    yottavol:
